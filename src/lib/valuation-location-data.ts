/**
 * Comprehensive US Metro Area Multipliers for Salon Valuation
 * Based on median home prices, business costs, and demand
 */

export interface MetroMultiplier {
  name: string;
  multiplier: number; // 1.0 = baseline, 1.25 = 25% premium
  zips: string[];
}

export const METRO_MULTIPLIERS: Record<string, MetroMultiplier> = {
  // TIER 1: Super Premium Markets (1.25-1.30x)
  'SF_BAY_AREA': {
    name: 'San Francisco Bay Area',
    multiplier: 1.30,
    zips: [
      // San Francisco
      '94102', '94103', '94104', '94105', '94107', '94108', '94109', '94110', '94111', '94112',
      '94114', '94115', '94116', '94117', '94118', '94121', '94122', '94123', '94124', '94127',
      '94129', '94130', '94131', '94132', '94133', '94134',
      // Palo Alto, Mountain View, Sunnyvale
      '94301', '94302', '94303', '94304', '94305', '94306', '94040', '94041', '94043', '94085', '94086', '94087',
      // Cupertino, Los Gatos, Saratoga
      '95014', '95030', '95032', '95033', '95070',
    ]
  },
  'ORANGE_COUNTY_PREMIUM': {
    name: 'Orange County (Coastal)',
    multiplier: 1.25,
    zips: [
      '92625', '92626', '92660', '92661', '92662', '92663', // Newport Beach
      '92651', '92652', '92653', '92654', // Laguna Beach, Laguna Niguel
      '92657', '92677', // Newport Coast, Laguna Niguel
      '92691', '92692', '92694', // Mission Viejo
      '92618', '92620', '92612', '92603', '92604', '92606', '92614', // Irvine
      '92704', '92705', '92706', '92707', '92708', // Santa Ana (select)
    ]
  },
  'LA_WEST_SIDE': {
    name: 'Los Angeles West Side',
    multiplier: 1.25,
    zips: [
      '90210', '90211', '90212', // Beverly Hills
      '90024', '90025', '90064', '90065', '90066', '90067', // West LA, Westwood
      '90272', '90291', '90292', // Pacific Palisades, Venice
      '90401', '90402', '90403', '90404', '90405', // Santa Monica
      '90049', '90077', // Bel Air, Brentwood
      '91302', '91361', '91362', '91364', // Calabasas, Westlake Village
    ]
  },

  // TIER 2: High-Demand Markets (1.15-1.20x)
  'SEATTLE': {
    name: 'Seattle Metro',
    multiplier: 1.20,
    zips: [
      '98101', '98102', '98103', '98104', '98105', '98107', '98109', '98112', '98115', '98116',
      '98117', '98118', '98119', '98121', '98122', '98125', '98126', '98133', '98134', '98144',
      '98004', '98005', '98006', '98007', '98008', '98033', '98039', '98040', // Bellevue, Redmond
      '98052', '98053', // Redmond
    ]
  },
  'SAN_DIEGO': {
    name: 'San Diego County',
    multiplier: 1.18,
    zips: [
      '92101', '92102', '92103', '92104', '92105', '92106', '92107', '92108', '92109', '92110',
      '92111', '92116', '92117', '92118', '92120', '92121', '92122', '92123', '92124', '92126',
      '92127', '92128', '92129', '92130', '92131', '92132', '92134', '92135', '92139', '92140',
      '92154', '92173',
      '92009', '92011', '92014', '92024', '92029', '92037', '92067', '92075', // La Jolla, Del Mar, Encinitas
    ]
  },
  'AUSTIN': {
    name: 'Austin Metro',
    multiplier: 1.18,
    zips: [
      '78701', '78702', '78703', '78704', '78705', '78717', '78721', '78722', '78723', '78724',
      '78727', '78728', '78729', '78730', '78731', '78732', '78733', '78734', '78735', '78736',
      '78737', '78738', '78739', '78741', '78744', '78745', '78746', '78747', '78748', '78749',
      '78750', '78751', '78752', '78753', '78754', '78756', '78757', '78758', '78759',
    ]
  },
  'DENVER': {
    name: 'Denver Metro',
    multiplier: 1.15,
    zips: [
      '80202', '80203', '80204', '80205', '80206', '80207', '80209', '80210', '80211', '80212',
      '80218', '80219', '80220', '80221', '80222', '80223', '80224', '80226', '80227', '80230',
      '80231', '80237', '80238', '80246', '80247', '80249', '80264',
      // Cherry Creek, Highlands, LoDo
    ]
  },

  // TIER 3: Strong Markets (1.10-1.15x)
  'BOSTON': {
    name: 'Boston Metro',
    multiplier: 1.15,
    zips: [
      '02108', '02109', '02110', '02111', '02113', '02114', '02115', '02116', '02118', '02119',
      '02120', '02121', '02122', '02124', '02125', '02126', '02127', '02128', '02129', '02130',
      '02131', '02132', '02134', '02135', '02136', '02163', '02199', '02210', '02215',
      '02138', '02139', '02140', '02141', '02142', '02143', '02144', '02145', // Cambridge
    ]
  },
  'MIAMI': {
    name: 'Miami-Dade County',
    multiplier: 1.12,
    zips: [
      '33109', '33125', '33126', '33127', '33128', '33129', '33130', '33131', '33132', '33133',
      '33134', '33135', '33136', '33137', '33138', '33139', '33140', '33141', '33142', '33143',
      '33144', '33145', '33146', '33147', '33149', '33150', '33154', '33155', '33156', '33157',
      '33158', '33160', '33161', '33162', '33165', '33166', '33167', '33168', '33169', '33170',
      '33172', '33173', '33174', '33175', '33176', '33177', '33178', '33179', '33180', '33181',
      '33183', '33184', '33185', '33186', '33187', '33189', '33190', '33193', '33194', '33196',
    ]
  },
  'ATLANTA': {
    name: 'Atlanta Metro',
    multiplier: 1.10,
    zips: [
      '30303', '30305', '30306', '30307', '30308', '30309', '30310', '30311', '30312', '30313',
      '30314', '30315', '30316', '30317', '30318', '30319', '30324', '30326', '30327', '30328',
      '30329', '30331', '30332', '30334', '30336', '30338', '30339', '30340', '30341', '30342',
      '30344', '30345', '30346', '30348', '30349', '30350', '30354', '30360', '30363', '30368',
    ]
  },

  // TIER 4: Moderate Markets (1.05-1.10x)
  'DALLAS': {
    name: 'Dallas-Fort Worth',
    multiplier: 1.08,
    zips: [
      '75201', '75202', '75203', '75204', '75205', '75206', '75207', '75208', '75209', '75210',
      '75211', '75212', '75214', '75215', '75216', '75217', '75218', '75219', '75220', '75223',
      '75224', '75225', '75226', '75227', '75228', '75229', '75230', '75231', '75232', '75233',
      '75234', '75235', '75236', '75237', '75238', '75240', '75241', '75243', '75244', '75246',
      '75247', '75248', '75249', '75251', '75252', '75253', '75254',
    ]
  },
  'HOUSTON': {
    name: 'Houston Metro',
    multiplier: 1.05,
    zips: [
      '77002', '77003', '77004', '77005', '77006', '77007', '77008', '77009', '77010', '77011',
      '77012', '77013', '77014', '77015', '77016', '77017', '77018', '77019', '77020', '77021',
      '77022', '77023', '77024', '77025', '77026', '77027', '77028', '77029', '77030', '77031',
      '77033', '77034', '77035', '77036', '77037', '77038', '77039', '77040', '77041', '77042',
      '77043', '77044', '77045', '77046', '77047', '77048', '77049', '77050', '77051', '77053',
      '77054', '77055', '77056', '77057', '77058', '77059', '77060', '77061', '77062', '77063',
      '77064', '77065', '77066', '77067', '77068', '77069', '77070', '77071', '77072', '77073',
      '77074', '77075', '77076', '77077', '77078', '77079', '77080', '77081', '77082', '77083',
      '77084', '77085', '77086', '77087', '77088', '77089', '77090', '77091', '77092', '77093',
      '77094', '77095', '77096', '77098', '77099',
    ]
  },
  'PHOENIX': {
    name: 'Phoenix Metro',
    multiplier: 1.05,
    zips: [
      '85001', '85003', '85004', '85006', '85007', '85008', '85009', '85012', '85013', '85014',
      '85015', '85016', '85017', '85018', '85019', '85020', '85021', '85022', '85023', '85024',
      '85027', '85028', '85029', '85031', '85032', '85033', '85034', '85035', '85037', '85040',
      '85041', '85042', '85043', '85044', '85045', '85048', '85050', '85051', '85053', '85054',
      '85083', '85085', '85086', '85087',
      // Scottsdale premium
      '85250', '85251', '85253', '85254', '85255', '85256', '85257', '85258', '85259', '85260',
      '85261', '85262', '85263', '85264', '85266', '85268',
    ]
  },
};

/**
 * Get location multiplier based on ZIP code
 * Returns 1.0 (baseline) if ZIP not found in premium markets
 */
export function getLocationMultiplier(zipCode: string): {
  multiplier: number;
  areaName: string;
  isPremuim: boolean;
} {
  // Normalize ZIP (remove spaces, dashes)
  const cleanZip = zipCode.trim().replace(/[-\s]/g, '').slice(0, 5);
  
  // Search through all metro areas
  for (const [key, metro] of Object.entries(METRO_MULTIPLIERS)) {
    if (metro.zips.includes(cleanZip)) {
      return {
        multiplier: metro.multiplier,
        areaName: metro.name,
        isPremuim: true
      };
    }
  }
  
  // Default: no premium
  return {
    multiplier: 1.0,
    areaName: 'Standard Market',
    isPremuim: false
  };
}

/**
 * Calculate dollar amount of location premium
 */
export function calculateLocationPremium(baseValue: number, zipCode: string): {
  premium: number;
  multiplier: number;
  areaName: string;
} {
  const { multiplier, areaName } = getLocationMultiplier(zipCode);
  const premium = baseValue * (multiplier - 1.0);
  
  return {
    premium: Math.round(premium),
    multiplier,
    areaName
  };
}
